<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Terra Numerica - Atelier Graphes</title>
  <script src="https://unpkg.com/cytoscape@3.26.0/dist/cytoscape.min.js"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <header id="tn-header">
    <div class="tn-container">
      <div class="tn-logo">
        <img src="public/terra_numerica_logo.png" alt="Terra Numerica">
      </div>
      <nav class="tn-nav">
        <a href="#" class="active">L'Atelier Graphes</a>
        <a href="https://terra-numerica.org/" target="_blank">Retour au site</a>
      </nav>
    </div>
  </header>

  <main class="grid">
    <section id="zone-3">
      <div>
        <h1>Consignes</h1>
        <p>
          Choisis un <strong>mode</strong> : <em>Personnalis√©</em> ou <em>Niveaux</em>.<br>
          Cr√©ez, modifiez et explorez les graphes k-partites.
        </p>
      </div>
      <div id="zone-4">
        <button class="info-btn" id="openHelp" aria-label="Informations">i</button>
      </div>
    </section>

    <section id="zone-1" aria-label="Zone graphe">
      <div id="cy" role="application" aria-label="Graphe Cytoscape"></div>
    </section>

    <aside id="zone-2" aria-label="Panneau de contr√¥le">
      <div class="card">
        <h3>Mode</h3>
        <div class="row">
          <select id="mode" style="width:100%">
            <option value="editor" selected>√âditeur de graphe</option>
            <option value="levels">Niveaux</option>
            <option value="templates">Templates</option>
          </select>
        </div>

        <div id="editor-controls" class="editor-panel">
          <h3>Cr√©ation</h3>
          <div class="row gap-sm">
            <input type="number" id="nodePart" min="1" max="10" value="1" style="width:50px" title="Num√©ro de partie">
            <input type="text" id="nodeLabel" placeholder="Nom du n≈ìud" style="flex:1">
          </div>
          <button class="primary" id="btnAddNode" style="width:100%; margin-top:8px">Ajouter un n≈ìud</button>

          <h3>Fichier</h3>
          <div class="row" style="gap:6px">
            <button class="secondary" id="btnExportJSON" style="flex:1">Exporter</button>
            <button class="secondary" id="btnImportJSON" style="flex:1">Importer</button>
          </div>
          <input type="file" id="fileInput" accept=".json" style="display:none">
          
          <div class="row" style="margin-top:10px">
             <button class="ghost" id="btnClear" style="width:100%">Tout effacer</button>
          </div>
        </div>

        <div id="level-controls" class="hidden" style="margin-top:10px">
          <h3>Choix du niveau</h3>
          <select id="level" style="width:100%; margin-bottom:8px"></select>
          <button class="primary" id="btnLoadLevel" style="width:100%">Charger le niveau</button>
        </div>

        <div id="template-controls" class="hidden" style="margin-top:10px">
          <h3>Choix du mod√®le</h3>
          <select id="template" style="width:100%; margin-bottom:8px">
            <option value="">-- S√©lectionner --</option>
            <option value="k3_3">K3,3 (Bipartite complet)</option>
            <option value="k3_3_3">K3,3,3 (Tripartite complet)</option>
            <option value="k3_3_3_3">K3,3,3,3 (Quadripartite complet)</option>
          </select>
          <button class="primary" id="btnLoadTemplate" style="width:100%">Charger le mod√®le</button>
        </div>
      </div>

      <div class="card">
        <h3>Outils</h3>
        <p id="stats" class="hint" style="margin-bottom:10px; text-align:center">‚Äî</p>
        
        <div class="row" style="margin-bottom:8px">
             <button id="btnEdgeColor" class="color-cycle color-grey" style="width:100%">Couleur : Gris</button>
        </div>
        
        <button class="ghost" id="btnPotential" style="width:100%; margin-bottom:8px">Voir ar√™tes possibles</button>
        
        <div class="row">
          <button id="btnLayout" class="ghost" style="flex:1">R√©organiser</button>
          <button id="btnFit" class="ghost" style="flex:1">Centrer</button>
        </div>
        
        <div class="row" style="margin-top:15px">
          <button id="btnDeleteNode" class="danger" style="width:100%">Supprimer la s√©lection</button>
        </div>
        <button id="btnRandom" style="display:none"></button>
      </div>
    </aside>
  </main>

  <dialog id="help">
    <div class="modal-header">
      <strong>Guide d'utilisation</strong>
      <button class="info-btn" id="closeHelp" aria-label="Fermer" style="background:transparent; border:1px solid white;">√ó</button>
    </div>
    <div class="modal-body">
      <h3 style="margin-top:0">Bienvenue sur l'Atelier Graphes</h3>
      <p>Cette application vous permet de manipuler des graphes aux couleurs de <strong>Terra Numerica</strong>.</p>

      <h3>üõ†Ô∏è Fonctionnalit√©s Cl√©s</h3>
      
      <p><strong>üü¢üî¥ Gestion des Couleurs</strong><br>
      Utilisez le bouton "Couleur" (√† droite) pour :
      <ul>
        <li>Choisir la couleur des <em>prochaines</em> ar√™tes que vous tracerez.</li>
        <li>Changer la couleur des ar√™tes d√©j√† <em>s√©lectionn√©es</em> (elles se d√©s√©lectionnent ensuite pour afficher le r√©sultat).</li>
      </ul>
      <em>Astuce : Utilisez le Vert pour "s√ªr" et le Rouge pour "impossible".</em></p>

      <p><strong>Mod√®les G√©om√©triques</strong><br>
      Les templates complets s'organisent automatiquement :
      <ul>
        <li><strong>K3,3</strong> (Bipartite) ‚Üí Colonnes</li>
        <li><strong>K3,3,3</strong> (Tripartite) ‚Üí Triangle</li>
        <li><strong>K3,3,3,3</strong> (Quadripartite) ‚Üí Carr√©</li>
      </ul>
      Cliquez sur <strong>"R√©organiser"</strong> pour retrouver ces formes parfaites.</p>

      <h3>Comment jouer ?</h3>
      
      <h4>Mode √âditeur</h4>
      <ul>
        <li><strong>Ajouter :</strong> Remplissez Partie/Label puis "Ajouter" (ou Entr√©e).</li>
        <li><strong>Lier :</strong> Cliquez sur un premier n≈ìud, puis sur un second.</li>
        <li><strong>Supprimer :</strong> Double-clic sur une ar√™te, ou s√©lection + bouton "Supprimer".</li>
      </ul>

      <h4>Mode Niveaux</h4>
      <ol>
        <li>Choisissez une √©nigme (ex: Motos).</li>
        <li>Lisez les indices en haut.</li>
        <li>Utilisez le bouton <strong>"Voir ar√™tes possibles"</strong> pour afficher en gris ce qu'il reste √† tester.</li>
      </ol>

      <h3>Sauvegarde</h3>
      <p>Utilisez les boutons <strong>Exporter / Importer JSON</strong> pour sauvegarder votre progression.</p>
      
      <hr style="margin: 20px 0; border: 0; border-top: 1px solid #eee;">
      <p style="text-align: center; font-style: italic; color: #666; font-size: 12px;">Application d√©velopp√©e pour Terra Numerica.</p>
    </div>
  </dialog>

  <script src="niveau1.js"></script>
  <script src="niveau2.js"></script>
  <script src="niveau3.js"></script>
  <script src="niveau4.js"></script>
  <script src="niveau5.js"></script>
  <script src="niveau6.js"></script>
  <script src="script.js"></script>

</body>
</html>